<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Eth::Tx::Eip1559
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Eth::Tx::Eip1559";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Eth.html" title="Eth (module)">Eth</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span>
     &raquo; 
    <span class="title">Eip1559</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Eth::Tx::Eip1559
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Eth::Tx::Eip1559</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/eth/tx/eip1559.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Provides support for EIP-1559 transactions utilizing EIP-2718 types and envelopes. Ref: <a href="https://eips.ethereum.org/EIPS/eip-1559">eips.ethereum.org/EIPS/eip-1559</a></p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#access_list-instance_method" title="#access_list (instance method)">#<strong>access_list</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>An optional EIP-2930 access list.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#amount-instance_method" title="#amount (instance method)">#<strong>amount</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The transaction amount in Wei.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#chain_id-instance_method" title="#chain_id (instance method)">#<strong>chain_id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The EIP-155 Chain ID.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#destination-instance_method" title="#destination (instance method)">#<strong>destination</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The recipient address.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#gas_limit-instance_method" title="#gas_limit (instance method)">#<strong>gas_limit</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The gas limit for the transaction.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#max_fee_per_gas-instance_method" title="#max_fee_per_gas (instance method)">#<strong>max_fee_per_gas</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The transaction max fee per gas in Wei.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#max_priority_fee_per_gas-instance_method" title="#max_priority_fee_per_gas (instance method)">#<strong>max_priority_fee_per_gas</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The transaction max priority fee per gas in Wei.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#payload-instance_method" title="#payload (instance method)">#<strong>payload</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The transaction data payload.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sender-instance_method" title="#sender (instance method)">#<strong>sender</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The sender address.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#signature_r-instance_method" title="#signature_r (instance method)">#<strong>signature_r</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The signature <code>r</code> value.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#signature_s-instance_method" title="#signature_s (instance method)">#<strong>signature_s</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The signature <code>s</code> value.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#signature_y_parity-instance_method" title="#signature_y_parity (instance method)">#<strong>signature_y_parity</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The signatureâ€™s y-parity byte (not v).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#signer_nonce-instance_method" title="#signer_nonce (instance method)">#<strong>signer_nonce</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The transaction nonce provided by the signer.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#type-instance_method" title="#type (instance method)">#<strong>type</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The transaction type.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decode-instance_method" title="#decode (instance method)">#<strong>decode</strong>(hex)  &#x21d2; Eth::Tx::Eip1559 </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Decodes a raw transaction hex into an <span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eip1559</a></span> transaction object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#encoded-instance_method" title="#encoded (instance method)">#<strong>encoded</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Encodes a raw transaction object, wraps it in an EIP-2718 envelope with an EIP-1559 type prefix.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hash-instance_method" title="#hash (instance method)">#<strong>hash</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets the transaction hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hex-instance_method" title="#hex (instance method)">#<strong>hex</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets the encoded, enveloped, raw transaction hex.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(params)  &#x21d2; Eip1559 </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a type-2 (EIP-1559) transaction payload object that can be prepared for envelope, signature and broadcast.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sign-instance_method" title="#sign (instance method)">#<strong>sign</strong>(key)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sign the transaction with a given key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unsigned_copy-instance_method" title="#unsigned_copy (instance method)">#<strong>unsigned_copy</strong>(tx)  &#x21d2; Eth::Tx::Eip1559 </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates an unsigned copy of a transaction payload.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unsigned_encoded-instance_method" title="#unsigned_encoded (instance method)">#<strong>unsigned_encoded</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Encodes the unsigned transaction payload in an EIP-1559 envelope, required for signing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unsigned_hash-instance_method" title="#unsigned_hash (instance method)">#<strong>unsigned_hash</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets the sign-hash required to sign a raw transaction.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(params)  &#x21d2; <tt><span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eip1559</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a type-2 (EIP-1559) transaction payload object that can be prepared for envelope, signature and broadcast. Ref: <a href="https://eips.ethereum.org/EIPS/eip-1559">eips.ethereum.org/EIPS/eip-1559</a></p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>all necessary transaction fields.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:chain_id</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the chain ID.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:nonce</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the signer nonce.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:priority_fee</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the max priority fee per gas.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:max_gas_fee</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the max transaction fee per gas.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:gas_limit</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the gas limit.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:from</span>
          <span class="type">(<tt><span class='object_link'><a href="../Address.html" title="Eth::Address (class)">Eth::Address</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the sender address.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:to</span>
          <span class="type">(<tt><span class='object_link'><a href="../Address.html" title="Eth::Address (class)">Eth::Address</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the reciever address.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:value</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the transaction value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:data</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>the transaction data payload.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:access_list</span>
          <span class="type">(<tt>Array</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>an optional access list.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ParameterError.html" title="Eth::Tx::ParameterError (class)">ParameterError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if gas limit is too low.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fields'>fields</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>recovery_id:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>r:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>s:</span> <span class='int'>0</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span> <span class='id identifier rubyid_params'>params</span>

  <span class='comment'># populate optional fields with serializable empty values
</span>  <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:chain_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_chain'><span class='object_link'><a href="../Tx.html#sanitize_chain-instance_method" title="Eth::Tx#sanitize_chain (method)">sanitize_chain</a></span></span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:chain_id</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:from</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_address'><span class='object_link'><a href="../Tx.html#sanitize_address-instance_method" title="Eth::Tx#sanitize_address (method)">sanitize_address</a></span></span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:from</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:to</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_address'><span class='object_link'><a href="../Tx.html#sanitize_address-instance_method" title="Eth::Tx#sanitize_address (method)">sanitize_address</a></span></span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:to</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_amount'><span class='object_link'><a href="../Tx.html#sanitize_amount-instance_method" title="Eth::Tx#sanitize_amount (method)">sanitize_amount</a></span></span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_data'><span class='object_link'><a href="../Tx.html#sanitize_data-instance_method" title="Eth::Tx#sanitize_data (method)">sanitize_data</a></span></span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span>

  <span class='comment'># ensure sane values for all mandatory fields
</span>  <span class='id identifier rubyid_fields'>fields</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_validate_params'><span class='object_link'><a href="../Tx.html#validate_params-instance_method" title="Eth::Tx#validate_params (method)">validate_params</a></span></span> <span class='id identifier rubyid_fields'>fields</span>
  <span class='id identifier rubyid_fields'>fields</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_validate_eip1559_params'><span class='object_link'><a href="../Tx.html#validate_eip1559_params-instance_method" title="Eth::Tx#validate_eip1559_params (method)">validate_eip1559_params</a></span></span> <span class='id identifier rubyid_fields'>fields</span>
  <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:access_list</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_list'><span class='object_link'><a href="../Tx.html#sanitize_list-instance_method" title="Eth::Tx#sanitize_list (method)">sanitize_list</a></span></span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:access_list</span><span class='rbracket'>]</span>

  <span class='comment'># ensure gas limit is not too low
</span>  <span class='id identifier rubyid_minimum_cost'>minimum_cost</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_estimate_intrinsic_gas'><span class='object_link'><a href="../Tx.html#estimate_intrinsic_gas-instance_method" title="Eth::Tx#estimate_intrinsic_gas (method)">estimate_intrinsic_gas</a></span></span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:access_list</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="ParameterError.html" title="Eth::Tx::ParameterError (class)">ParameterError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Transaction gas limit is too low, try </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_minimum_cost'>minimum_cost</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:gas_limit</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_minimum_cost'>minimum_cost</span>

  <span class='comment'># populate class attributes
</span>  <span class='ivar'>@signer_nonce</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:nonce</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@max_priority_fee_per_gas</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:priority_fee</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@max_fee_per_gas</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:max_gas_fee</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@gas_limit</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:gas_limit</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@sender</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:from</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='ivar'>@destination</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:to</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='ivar'>@amount</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@payload</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span>
  <span class='ivar'>@access_list</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:access_list</span><span class='rbracket'>]</span>

  <span class='comment'># the signature v is set to the chain id for unsigned transactions
</span>  <span class='ivar'>@signature_y_parity</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:recovery_id</span><span class='rbracket'>]</span>
  <span class='ivar'>@chain_id</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:chain_id</span><span class='rbracket'>]</span>

  <span class='comment'># the signature fields are empty for unsigned transactions.
</span>  <span class='ivar'>@signature_r</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:r</span><span class='rbracket'>]</span>
  <span class='ivar'>@signature_s</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='lbracket'>[</span><span class='symbol'>:s</span><span class='rbracket'>]</span>

  <span class='comment'># last but not least, set the type.
</span>  <span class='ivar'>@type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html#TYPE_1559-constant" title="Eth::Tx::TYPE_1559 (constant)">TYPE_1559</a></span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="access_list-instance_method">
  
    #<strong>access_list</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>An optional EIP-2930 access list. Ref: <a href="https://eips.ethereum.org/EIPS/eip-2930">eips.ethereum.org/EIPS/eip-2930</a></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_access_list'>access_list</span>
  <span class='ivar'>@access_list</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="amount-instance_method">
  
    #<strong>amount</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The transaction amount in Wei.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 46</span>

<span class='kw'>def</span> <span class='id identifier rubyid_amount'>amount</span>
  <span class='ivar'>@amount</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="chain_id-instance_method">
  
    #<strong>chain_id</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The EIP-155 Chain ID. Ref: <a href="https://eips.ethereum.org/EIPS/eip-155">eips.ethereum.org/EIPS/eip-155</a></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29
30</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 28</span>

<span class='kw'>def</span> <span class='id identifier rubyid_chain_id'>chain_id</span>
  <span class='ivar'>@chain_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="destination-instance_method">
  
    #<strong>destination</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The recipient address.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 43</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destination'>destination</span>
  <span class='ivar'>@destination</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="gas_limit-instance_method">
  
    #<strong>gas_limit</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The gas limit for the transaction.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40
41
42</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 40</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gas_limit'>gas_limit</span>
  <span class='ivar'>@gas_limit</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="max_fee_per_gas-instance_method">
  
    #<strong>max_fee_per_gas</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The transaction max fee per gas in Wei.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 37</span>

<span class='kw'>def</span> <span class='id identifier rubyid_max_fee_per_gas'>max_fee_per_gas</span>
  <span class='ivar'>@max_fee_per_gas</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="max_priority_fee_per_gas-instance_method">
  
    #<strong>max_priority_fee_per_gas</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The transaction max priority fee per gas in Wei.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 34</span>

<span class='kw'>def</span> <span class='id identifier rubyid_max_priority_fee_per_gas'>max_priority_fee_per_gas</span>
  <span class='ivar'>@max_priority_fee_per_gas</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="payload-instance_method">
  
    #<strong>payload</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The transaction data payload.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 49</span>

<span class='kw'>def</span> <span class='id identifier rubyid_payload'>payload</span>
  <span class='ivar'>@payload</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="sender-instance_method">
  
    #<strong>sender</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The sender address.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 65</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sender'>sender</span>
  <span class='ivar'>@sender</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="signature_r-instance_method">
  
    #<strong>signature_r</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The signature <code>r</code> value.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_signature_r'>signature_r</span>
  <span class='ivar'>@signature_r</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="signature_s-instance_method">
  
    #<strong>signature_s</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The signature <code>s</code> value.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 62</span>

<span class='kw'>def</span> <span class='id identifier rubyid_signature_s'>signature_s</span>
  <span class='ivar'>@signature_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="signature_y_parity-instance_method">
  
    #<strong>signature_y_parity</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The signatureâ€™s y-parity byte (not v).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_signature_y_parity'>signature_y_parity</span>
  <span class='ivar'>@signature_y_parity</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="signer_nonce-instance_method">
  
    #<strong>signer_nonce</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The transaction nonce provided by the signer.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32
33</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 31</span>

<span class='kw'>def</span> <span class='id identifier rubyid_signer_nonce'>signer_nonce</span>
  <span class='ivar'>@signer_nonce</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="type-instance_method">
  
    #<strong>type</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The transaction type.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 68</span>

<span class='kw'>def</span> <span class='id identifier rubyid_type'>type</span>
  <span class='ivar'>@type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="decode-instance_method">
  
    #<strong>decode</strong>(hex)  &#x21d2; <tt><span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eth::Tx::Eip1559</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Decodes a raw transaction hex into an <span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eth::Tx::Eip1559</a></span> transaction object.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>hex</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the raw transaction hex-string.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eth::Tx::Eip1559</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>transaction payload.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="TransactionTypeError.html" title="Eth::Tx::TransactionTypeError (class)">TransactionTypeError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if transaction type is invalid.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ParameterError.html" title="Eth::Tx::ParameterError (class)">ParameterError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if transaction is missing fields.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DecoderError.html" title="Eth::Tx::DecoderError (class)">DecoderError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if transaction decoding fails.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 139</span>

<span class='kw'>def</span> <span class='id identifier rubyid_decode'>decode</span><span class='lparen'>(</span><span class='id identifier rubyid_hex'>hex</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hex'>hex</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_remove_hex_prefix'><span class='object_link'><a href="../Util.html#remove_hex_prefix-instance_method" title="Eth::Util#remove_hex_prefix (method)">remove_hex_prefix</a></span></span> <span class='id identifier rubyid_hex'>hex</span>
  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_hex'>hex</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>2</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="TransactionTypeError.html" title="Eth::Tx::TransactionTypeError (class)">TransactionTypeError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid transaction type </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_type'>type</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='const'><span class='object_link'><a href="../Tx.html#TYPE_1559-constant" title="Eth::Tx::TYPE_1559 (constant)">TYPE_1559</a></span></span>

  <span class='id identifier rubyid_bin'>bin</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_hex_to_bin'><span class='object_link'><a href="../Util.html#hex_to_bin-instance_method" title="Eth::Util#hex_to_bin (method)">hex_to_bin</a></span></span> <span class='id identifier rubyid_hex'>hex</span><span class='lbracket'>[</span><span class='int'>2</span><span class='op'>..</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_tx'>tx</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Rlp.html" title="Eth::Rlp (module)">Rlp</a></span></span><span class='period'>.</span><span class='id identifier rubyid_decode'><span class='object_link'><a href="../Rlp.html#decode-instance_method" title="Eth::Rlp#decode (method)">decode</a></span></span> <span class='id identifier rubyid_bin'>bin</span>

  <span class='comment'># decoded transactions always have 9 + 3 fields, even if they are empty or zero
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="ParameterError.html" title="Eth::Tx::ParameterError (class)">ParameterError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Transaction missing fields!</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='int'>9</span>

  <span class='comment'># populate the 9 payload fields
</span>  <span class='id identifier rubyid_chain_id'>chain_id</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_deserialize_big_endian_to_int'><span class='object_link'><a href="../Util.html#deserialize_big_endian_to_int-instance_method" title="Eth::Util#deserialize_big_endian_to_int (method)">deserialize_big_endian_to_int</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_nonce'>nonce</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_deserialize_big_endian_to_int'><span class='object_link'><a href="../Util.html#deserialize_big_endian_to_int-instance_method" title="Eth::Util#deserialize_big_endian_to_int (method)">deserialize_big_endian_to_int</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_priority_fee'>priority_fee</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_deserialize_big_endian_to_int'><span class='object_link'><a href="../Util.html#deserialize_big_endian_to_int-instance_method" title="Eth::Util#deserialize_big_endian_to_int (method)">deserialize_big_endian_to_int</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_max_gas_fee'>max_gas_fee</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_deserialize_big_endian_to_int'><span class='object_link'><a href="../Util.html#deserialize_big_endian_to_int-instance_method" title="Eth::Util#deserialize_big_endian_to_int (method)">deserialize_big_endian_to_int</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_gas_limit'>gas_limit</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_deserialize_big_endian_to_int'><span class='object_link'><a href="../Util.html#deserialize_big_endian_to_int-instance_method" title="Eth::Util#deserialize_big_endian_to_int (method)">deserialize_big_endian_to_int</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_to'>to</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bin_to_hex'><span class='object_link'><a href="../Util.html#bin_to_hex-instance_method" title="Eth::Util#bin_to_hex (method)">bin_to_hex</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>5</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_deserialize_big_endian_to_int'><span class='object_link'><a href="../Util.html#deserialize_big_endian_to_int-instance_method" title="Eth::Util#deserialize_big_endian_to_int (method)">deserialize_big_endian_to_int</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>6</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>7</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_access_list'>access_list</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>8</span><span class='rbracket'>]</span>

  <span class='comment'># populate class attributes
</span>  <span class='ivar'>@chain_id</span> <span class='op'>=</span> <span class='id identifier rubyid_chain_id'>chain_id</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@signer_nonce</span> <span class='op'>=</span> <span class='id identifier rubyid_nonce'>nonce</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@max_priority_fee_per_gas</span> <span class='op'>=</span> <span class='id identifier rubyid_priority_fee'>priority_fee</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@max_fee_per_gas</span> <span class='op'>=</span> <span class='id identifier rubyid_max_gas_fee'>max_gas_fee</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@gas_limit</span> <span class='op'>=</span> <span class='id identifier rubyid_gas_limit'>gas_limit</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@destination</span> <span class='op'>=</span> <span class='id identifier rubyid_to'>to</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='ivar'>@amount</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='ivar'>@payload</span> <span class='op'>=</span> <span class='id identifier rubyid_data'>data</span>
  <span class='ivar'>@access_list</span> <span class='op'>=</span> <span class='id identifier rubyid_access_list'>access_list</span>

  <span class='comment'># populate the 3 signature fields
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>9</span>
    <span class='id identifier rubyid__set_signature'>_set_signature</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>12</span>
    <span class='id identifier rubyid_recovery_id'>recovery_id</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bin_to_hex'><span class='object_link'><a href="../Util.html#bin_to_hex-instance_method" title="Eth::Util#bin_to_hex (method)">bin_to_hex</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>9</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bin_to_hex'><span class='object_link'><a href="../Util.html#bin_to_hex-instance_method" title="Eth::Util#bin_to_hex (method)">bin_to_hex</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>10</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bin_to_hex'><span class='object_link'><a href="../Util.html#bin_to_hex-instance_method" title="Eth::Util#bin_to_hex (method)">bin_to_hex</a></span></span> <span class='id identifier rubyid_tx'>tx</span><span class='lbracket'>[</span><span class='int'>11</span><span class='rbracket'>]</span>

    <span class='comment'># allows us to force-setting a signature if the transaction is signed already
</span>    <span class='id identifier rubyid__set_signature'>_set_signature</span><span class='lparen'>(</span><span class='id identifier rubyid_recovery_id'>recovery_id</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DecoderError.html" title="Eth::Tx::DecoderError (class)">DecoderError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot decode EIP-1559 payload!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># last but not least, set the type.
</span>  <span class='ivar'>@type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html#TYPE_1559-constant" title="Eth::Tx::TYPE_1559 (constant)">TYPE_1559</a></span></span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_recovery_id'>recovery_id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='comment'># recover sender address
</span>    <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Chain.html" title="Eth::Chain (module)">Chain</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_v'><span class='object_link'><a href="../Chain.html#to_v-instance_method" title="Eth::Chain#to_v (method)">to_v</a></span></span> <span class='id identifier rubyid_recovery_id'>recovery_id</span><span class='comma'>,</span> <span class='id identifier rubyid_chain_id'>chain_id</span>
    <span class='id identifier rubyid_public_key'>public_key</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Signature.html" title="Eth::Signature (module)">Signature</a></span></span><span class='period'>.</span><span class='id identifier rubyid_recover'><span class='object_link'><a href="../Signature.html#recover-instance_method" title="Eth::Signature#recover (method)">recover</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_unsigned_hash'>unsigned_hash</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_rjust'>rjust</span><span class='lparen'>(</span><span class='int'>64</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_rjust'>rjust</span><span class='lparen'>(</span><span class='int'>64</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_chain_id'>chain_id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_address'>address</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_public_key_to_address'><span class='object_link'><a href="../Util.html#public_key_to_address-instance_method" title="Eth::Util#public_key_to_address (method)">public_key_to_address</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_public_key'>public_key</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='ivar'>@sender</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_address'><span class='object_link'><a href="../Tx.html#sanitize_address-instance_method" title="Eth::Tx#sanitize_address (method)">sanitize_address</a></span></span> <span class='id identifier rubyid_address'>address</span>
  <span class='kw'>else</span>
    <span class='comment'># keep the &#39;from&#39; field blank
</span>    <span class='ivar'>@sender</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_address'><span class='object_link'><a href="../Tx.html#sanitize_address-instance_method" title="Eth::Tx#sanitize_address (method)">sanitize_address</a></span></span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="encoded-instance_method">
  
    #<strong>encoded</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Encodes a raw transaction object, wraps it in an EIP-2718 envelope with an EIP-1559 type prefix.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a raw, RLP-encoded EIP-1559 type transaction object.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Signature/SignatureError.html" title="Eth::Signature::SignatureError (class)">Signature::SignatureError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if the transaction is not yet signed.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 265</span>

<span class='kw'>def</span> <span class='id identifier rubyid_encoded'>encoded</span>
  <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_signed?'><span class='object_link'><a href="../Tx.html#signed%3F-instance_method" title="Eth::Tx#signed? (method)">signed?</a></span></span> <span class='kw'>self</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../Signature.html" title="Eth::Signature (module)">Signature</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Signature/SignatureError.html" title="Eth::Signature::SignatureError (class)">SignatureError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Transaction is not signed!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@chain_id</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@signer_nonce</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@max_priority_fee_per_gas</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@max_fee_per_gas</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@gas_limit</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_hex_to_bin'><span class='object_link'><a href="../Util.html#hex_to_bin-instance_method" title="Eth::Util#hex_to_bin (method)">hex_to_bin</a></span></span> <span class='ivar'>@destination</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@amount</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Rlp.html" title="Eth::Rlp (module)">Rlp</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Rlp/Sedes.html" title="Eth::Rlp::Sedes (module)">Sedes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_binary'><span class='object_link'><a href="../Rlp/Sedes.html#binary-class_method" title="Eth::Rlp::Sedes.binary (method)">binary</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize'><span class='object_link'><a href="../Rlp/Sedes/Binary.html#serialize-instance_method" title="Eth::Rlp::Sedes::Binary#serialize (method)">serialize</a></span></span> <span class='ivar'>@payload</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Rlp.html" title="Eth::Rlp (module)">Rlp</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Rlp/Sedes.html" title="Eth::Rlp::Sedes (module)">Sedes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_infer'><span class='object_link'><a href="../Rlp/Sedes.html#infer-class_method" title="Eth::Rlp::Sedes.infer (method)">infer</a></span></span><span class='lparen'>(</span><span class='ivar'>@access_list</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_serialize'>serialize</span> <span class='ivar'>@access_list</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@signature_y_parity</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@signature_r</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@signature_s</span>
  <span class='id identifier rubyid_tx_encoded'>tx_encoded</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Rlp.html" title="Eth::Rlp (module)">Rlp</a></span></span><span class='period'>.</span><span class='id identifier rubyid_encode'><span class='object_link'><a href="../Rlp.html#encode-instance_method" title="Eth::Rlp#encode (method)">encode</a></span></span> <span class='id identifier rubyid_tx_data'>tx_data</span>

  <span class='comment'># create an EIP-2718 envelope with EIP-1559 type payload
</span>  <span class='id identifier rubyid_tx_type'>tx_type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@type</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tx_type'>tx_type</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tx_encoded'>tx_encoded</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="hash-instance_method">
  
    #<strong>hash</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets the transaction hash.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the transaction hash.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


299
300
301</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 299</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hash'>hash</span>
  <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bin_to_hex'><span class='object_link'><a href="../Util.html#bin_to_hex-instance_method" title="Eth::Util#bin_to_hex (method)">bin_to_hex</a></span></span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_keccak256'><span class='object_link'><a href="../Util.html#keccak256-instance_method" title="Eth::Util#keccak256 (method)">keccak256</a></span></span> <span class='id identifier rubyid_encoded'>encoded</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="hex-instance_method">
  
    #<strong>hex</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets the encoded, enveloped, raw transaction hex.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the raw transaction hex.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


292
293
294</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 292</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hex'>hex</span>
  <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bin_to_hex'><span class='object_link'><a href="../Util.html#bin_to_hex-instance_method" title="Eth::Util#bin_to_hex (method)">bin_to_hex</a></span></span> <span class='id identifier rubyid_encoded'>encoded</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sign-instance_method">
  
    #<strong>sign</strong>(key)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sign the transaction with a given key.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Key.html" title="Eth::Key (class)">Eth::Key</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the key-pair to use for signing.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a transaction hash.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Signature/SignatureError.html" title="Eth::Signature::SignatureError (class)">Signature::SignatureError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if transaction is already signed.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Signature/SignatureError.html" title="Eth::Signature::SignatureError (class)">Signature::SignatureError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if sender address does not match signing key.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 238</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sign'>sign</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_signed?'><span class='object_link'><a href="../Tx.html#signed%3F-instance_method" title="Eth::Tx#signed? (method)">signed?</a></span></span> <span class='kw'>self</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../Signature.html" title="Eth::Signature (module)">Signature</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Signature/SignatureError.html" title="Eth::Signature::SignatureError (class)">SignatureError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Transaction is already signed!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># ensure the sender address matches the given key
</span>  <span class='kw'>unless</span> <span class='ivar'>@sender</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='id identifier rubyid_sender'>sender</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_signer_address'>signer_address</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_address'><span class='object_link'><a href="../Tx.html#sanitize_address-instance_method" title="Eth::Tx#sanitize_address (method)">sanitize_address</a></span></span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='id identifier rubyid_from_address'>from_address</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_address'><span class='object_link'><a href="../Tx.html#sanitize_address-instance_method" title="Eth::Tx#sanitize_address (method)">sanitize_address</a></span></span> <span class='ivar'>@sender</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../Signature.html" title="Eth::Signature (module)">Signature</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Signature/SignatureError.html" title="Eth::Signature::SignatureError (class)">SignatureError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signer does not match sender</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_signer_address'>signer_address</span> <span class='op'>==</span> <span class='id identifier rubyid_from_address'>from_address</span>
  <span class='kw'>end</span>

  <span class='comment'># sign a keccak hash of the unsigned, encoded transaction
</span>  <span class='id identifier rubyid_signature'>signature</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_sign'>sign</span><span class='lparen'>(</span><span class='id identifier rubyid_unsigned_hash'>unsigned_hash</span><span class='comma'>,</span> <span class='ivar'>@chain_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_s'>s</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Signature.html" title="Eth::Signature (module)">Signature</a></span></span><span class='period'>.</span><span class='id identifier rubyid_dissect'><span class='object_link'><a href="../Signature.html#dissect-instance_method" title="Eth::Signature#dissect (method)">dissect</a></span></span> <span class='id identifier rubyid_signature'>signature</span>
  <span class='id identifier rubyid_recovery_id'>recovery_id</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Chain.html" title="Eth::Chain (module)">Chain</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_recovery_id'><span class='object_link'><a href="../Chain.html#to_recovery_id-instance_method" title="Eth::Chain#to_recovery_id (method)">to_recovery_id</a></span></span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='ivar'>@chain_id</span>
  <span class='ivar'>@signature_y_parity</span> <span class='op'>=</span> <span class='id identifier rubyid_recovery_id'>recovery_id</span>
  <span class='ivar'>@signature_r</span> <span class='op'>=</span> <span class='id identifier rubyid_r'>r</span>
  <span class='ivar'>@signature_s</span> <span class='op'>=</span> <span class='id identifier rubyid_s'>s</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_hash'>hash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unsigned_copy-instance_method">
  
    #<strong>unsigned_copy</strong>(tx)  &#x21d2; <tt><span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eth::Tx::Eip1559</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates an unsigned copy of a transaction payload.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tx</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eth::Tx::Eip1559</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an EIP-1559 transaction payload.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eth::Tx::Eip1559</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an unsigned EIP-1559 transaction payload.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="TransactionTypeError.html" title="Eth::Tx::TransactionTypeError (class)">TransactionTypeError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if transaction type does not match.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 206</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unsigned_copy'>unsigned_copy</span><span class='lparen'>(</span><span class='id identifier rubyid_tx'>tx</span><span class='rparen'>)</span>

  <span class='comment'># not checking transaction validity unless it&#39;s of a different class
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="TransactionTypeError.html" title="Eth::Tx::TransactionTypeError (class)">TransactionTypeError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot copy transaction of different payload type!</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_instance_of?'>instance_of?</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Eth::Tx::Eip1559 (class)">Eip1559</a></span></span>

  <span class='comment'># populate class attributes
</span>  <span class='ivar'>@signer_nonce</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_signer_nonce'>signer_nonce</span>
  <span class='ivar'>@max_priority_fee_per_gas</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_max_priority_fee_per_gas'>max_priority_fee_per_gas</span>
  <span class='ivar'>@max_fee_per_gas</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_max_fee_per_gas'>max_fee_per_gas</span>
  <span class='ivar'>@gas_limit</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_gas_limit'>gas_limit</span>
  <span class='ivar'>@destination</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_destination'>destination</span>
  <span class='ivar'>@amount</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span>
  <span class='ivar'>@payload</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_payload'>payload</span>
  <span class='ivar'>@access_list</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_access_list'>access_list</span>
  <span class='ivar'>@chain_id</span> <span class='op'>=</span> <span class='id identifier rubyid_tx'>tx</span><span class='period'>.</span><span class='id identifier rubyid_chain_id'>chain_id</span>

  <span class='comment'># force-set signature to unsigned
</span>  <span class='id identifier rubyid__set_signature'>_set_signature</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span>

  <span class='comment'># keep the &#39;from&#39; field blank
</span>  <span class='ivar'>@sender</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html" title="Eth::Tx (module)">Tx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_sanitize_address'><span class='object_link'><a href="../Tx.html#sanitize_address-instance_method" title="Eth::Tx#sanitize_address (method)">sanitize_address</a></span></span> <span class='kw'>nil</span>

  <span class='comment'># last but not least, set the type.
</span>  <span class='ivar'>@type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Tx.html#TYPE_1559-constant" title="Eth::Tx::TYPE_1559 (constant)">TYPE_1559</a></span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unsigned_encoded-instance_method">
  
    #<strong>unsigned_encoded</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Encodes the unsigned transaction payload in an EIP-1559 envelope, required for signing.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>an RLP-encoded, unsigned, enveloped EIP-1559 transaction.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 307</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unsigned_encoded'>unsigned_encoded</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@chain_id</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@signer_nonce</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@max_priority_fee_per_gas</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@max_fee_per_gas</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@gas_limit</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_hex_to_bin'><span class='object_link'><a href="../Util.html#hex_to_bin-instance_method" title="Eth::Util#hex_to_bin (method)">hex_to_bin</a></span></span> <span class='ivar'>@destination</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@amount</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Rlp.html" title="Eth::Rlp (module)">Rlp</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Rlp/Sedes.html" title="Eth::Rlp::Sedes (module)">Sedes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_binary'><span class='object_link'><a href="../Rlp/Sedes.html#binary-class_method" title="Eth::Rlp::Sedes.binary (method)">binary</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize'><span class='object_link'><a href="../Rlp/Sedes/Binary.html#serialize-instance_method" title="Eth::Rlp::Sedes::Binary#serialize (method)">serialize</a></span></span> <span class='ivar'>@payload</span>
  <span class='id identifier rubyid_tx_data'>tx_data</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span> <span class='const'><span class='object_link'><a href="../Rlp.html" title="Eth::Rlp (module)">Rlp</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Rlp/Sedes.html" title="Eth::Rlp::Sedes (module)">Sedes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_infer'><span class='object_link'><a href="../Rlp/Sedes.html#infer-class_method" title="Eth::Rlp::Sedes.infer (method)">infer</a></span></span><span class='lparen'>(</span><span class='ivar'>@access_list</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_serialize'>serialize</span> <span class='ivar'>@access_list</span>
  <span class='id identifier rubyid_tx_encoded'>tx_encoded</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Rlp.html" title="Eth::Rlp (module)">Rlp</a></span></span><span class='period'>.</span><span class='id identifier rubyid_encode'><span class='object_link'><a href="../Rlp.html#encode-instance_method" title="Eth::Rlp#encode (method)">encode</a></span></span> <span class='id identifier rubyid_tx_data'>tx_data</span>

  <span class='comment'># create an EIP-2718 envelope with EIP-1559 type payload (unsigned)
</span>  <span class='id identifier rubyid_tx_type'>tx_type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_serialize_int_to_big_endian'><span class='object_link'><a href="../Util.html#serialize_int_to_big_endian-instance_method" title="Eth::Util#serialize_int_to_big_endian (method)">serialize_int_to_big_endian</a></span></span> <span class='ivar'>@type</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tx_type'>tx_type</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tx_encoded'>tx_encoded</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unsigned_hash-instance_method">
  
    #<strong>unsigned_hash</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets the sign-hash required to sign a raw transaction.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a Keccak-256 hash of an unsigned transaction.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/eth/tx/eip1559.rb', line 328</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unsigned_hash'>unsigned_hash</span>
  <span class='const'><span class='object_link'><a href="../Util.html" title="Eth::Util (module)">Util</a></span></span><span class='period'>.</span><span class='id identifier rubyid_keccak256'><span class='object_link'><a href="../Util.html#keccak256-instance_method" title="Eth::Util#keccak256 (method)">keccak256</a></span></span> <span class='id identifier rubyid_unsigned_encoded'>unsigned_encoded</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Apr 11 15:10:25 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.2).
</div>

    </div>
  </body>
</html>